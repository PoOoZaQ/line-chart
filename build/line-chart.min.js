var directive,m,mod,old_m,__indexOf=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};old_m=angular.module("n3-charts.linechart",["n3charts.utils"]);m=angular.module("n3-line-chart",["n3charts.utils"]);directive=function(n,t){return old_m.directive(n,t),m.directive(n,t)};directive("linechart",["n3utils","$window","$timeout",function(n,t,i){var r;return r=function(r,u,f){var e,c,a,v,s,h,l,o;o=n;e=o.getEventDispatcher();c=o.uuid();u[0].style["font-size"]=0;r.redraw=function(){r.update()};v=!1;a={onSeriesVisibilityChange:function(n){var t,i,u;return u=n.series,t=n.index,i=n.newVisibility,r.options.series[t].visible=i,r.$apply()}};r.update=function(){var h,v,s,t,y,l,p,n,i;return n=o.sanitizeOptions(r.options,f.mode),l=angular.extend(a,o.getTooltipHandlers(n)),s=o.getDataPerSeries(r.data,n),t=o.getDimensions(n,u,f),p=f.mode==="thumbnail",o.clean(u[0]),i=o.bootstrap(u[0],c,t),y=function(t){return n.series.filter(function(n){return n.axis===t&&n.visible!==!1}).length>0},h=o.createAxes(i,t,n.axes).andAddThemIf({all:!p,x:!0,y:y("y"),y2:y("y2")}),s.length&&o.setScalesDomain(h,r.data,n.series,i,n),o.createContent(i,c,n,l),s.length&&(v=o.getBestColumnWidth(h,t,s,n),o.drawData(i,t,h,s,v,n,l,e)),n.drawLegend&&o.drawLegend(i,n.series,t,l,e),n.tooltip.mode==="scrubber"?o.createGlass(i,t,l,h,s,n,e,v):n.tooltip.mode!=="none"&&o.addTooltips(i,t,n.axes),o.createFocus(i,t,n),o.setZoom(i,t,h,s,v,n,l,e)};h=function(){if(r.oldclick)e.on("click",r.oldclick);else if(r.click)e.on("click",r.click);else e.on("click",null);if(r.oldhover)e.on("hover",r.oldhover);else if(r.hover)e.on("hover",r.hover);else e.on("hover",null);if(r.mouseenter)e.on("mouseenter",r.mouseenter);else e.on("mouseenter",null);if(r.mouseover)e.on("mouseover",r.mouseover);else e.on("mouseover",null);if(r.mouseout)e.on("mouseout",r.mouseout);else e.on("mouseout",null);if(r.oldfocus)e.on("focus",r.oldfocus);else if(r.focus)e.on("focus",r.focus);else e.on("focus",null);return r.toggle?e.on("toggle",r.toggle):e.on("toggle",null)};s=void 0;l=function(){return s!=null&&i.cancel(s),s=i(r.redraw,1)};t.addEventListener("resize",l);r.$watch("data",r.redraw,!0);r.$watch("options",r.redraw,!0);r.$watchCollection("[click, hover, focus, toggle]",h);r.$watchCollection("[mouseenter, mouseover, mouseout]",h);r.$watchCollection("[oldclick, oldhover, oldfocus]",h);r.$on("$destroy",function(){return t.removeEventListener("resize",l)})},{replace:!0,restrict:"E",scope:{data:"=",options:"=",oldclick:"=click",oldhover:"=hover",oldfocus:"=focus",click:"=onClick",hover:"=onHover",focus:"=onFocus",toggle:"=onToggle",mouseenter:"=onMouseenter",mouseover:"=onMouseover",mouseout:"=onMouseout"},template:"<div><\/div>",link:r}}]);mod=angular.module("n3charts.utils",[]);mod.factory("n3utils",["$window","$log","$rootScope",function(n,t){return{addPatterns:function(n,t){var i;return i=n.select("defs").selectAll("pattern").data(t.filter(function(n){return n.striped})).enter().append("pattern").attr({id:function(n){return n.type+"Pattern_"+n.index},patternUnits:"userSpaceOnUse",x:0,y:0,width:60,height:60}).append("g").style({fill:function(n){return n.color},"fill-opacity":.3}),i.append("rect").style("fill-opacity",.3).attr("width",60).attr("height",60),i.append("path").attr("d","M 10 0 l10 0 l -20 20 l 0 -10 z"),i.append("path").attr("d","M40 0 l10 0 l-50 50 l0 -10 z"),i.append("path").attr("d","M60 10 l0 10 l-40 40 l-10 0 z"),i.append("path").attr("d","M60 40 l0 10 l-10 10 l -10 0 z")},drawArea:function(n,t,i,r){var o,u,f,e;return f=i.filter(function(n){return n.type==="area"}),this.addPatterns(n,f),e={y:this.createLeftAreaDrawer(t,r.lineMode,r.tension),y2:this.createRightAreaDrawer(t,r.lineMode,r.tension)},u=n.select(".content").selectAll(".areaGroup").data(f),o=u.enter().append("g").attr("class",function(n){return"areaGroup series_"+n.index}),u.each(function(n){var t;return t=d3.select(this).selectAll("path").data([n]),t.enter().append("path").attr("class","area"),t.style("fill",function(n){return n.striped!==!0?n.color:"url(#areaPattern_"+n.index+")"}).style("opacity",function(n){return n.striped?"1":"0.3"}).attr("d",function(n){return e[n.axis](n.values)})}),this},createLeftAreaDrawer:function(n,t,i){return d3.svg.area().x(function(t){return n.xScale(t.x)}).y0(function(t){return n.yScale(t.y0)}).y1(function(t){return n.yScale(t.y0+t.y)}).interpolate(t).tension(i)},createRightAreaDrawer:function(n,t,i){return d3.svg.area().x(function(t){return n.xScale(t.x)}).y0(function(t){return n.y2Scale(t.y0)}).y1(function(t){return n.y2Scale(t.y0+t.y)}).interpolate(t).tension(i)},getPseudoColumns:function(n,t){var i,r;return n=n.filter(function(n){return n.type==="column"}),r={},i=[],n.forEach(function(n){var u,f,s,e,o;return u=t.series.map(function(n){return n.id}).indexOf(n.id),e=(o=t.series)!=null?o[u].visible:void 0,(e===void 0||e===!0)&&(f=!1,t.stacks.forEach(function(t,u){var e;if(n.id!=null&&(e=n.id,__indexOf.call(t.series,e)>=0))return r[n.id]=u,__indexOf.call(i,u)<0&&i.push(u),f=!0}),f===!1)?(u=r[n.id]=s=i.length,i.push(u)):void 0}),{pseudoColumns:r,keys:i}},getMinDelta:function(n,t,i,r){return d3.min(n.map(function(n){return n.values.map(function(n){return i(n[t])}).filter(function(n){return r?n>=r[0]&&n<=r[1]:!0}).reduce(function(n,t,i,r){var u;return u=i>0?Math.max(t-r[i-1],0):Number.MAX_VALUE,u<n?u:n},Number.MAX_VALUE)}))},getBestColumnWidth:function(n,t,i,r){var s,u,f,h,e,c,o;return(i&&i.length!==0)?i.filter(function(n){return n.type==="column"}).length===0?10:(o=this.getPseudoColumns(i,r),c=o.pseudoColumns,h=o.keys,f=t.width-t.left-t.right,s=i.filter(function(n){return c.hasOwnProperty(n.id)}),u=this.getMinDelta(s,"x",n.xScale,[0,f]),u>f&&(u=.25*f),e=h.length,r.columnsHGap<u?Math.max(1,(u-r.columnsHGap)/e):Math.max(1,u*.8/e)):10},getColumnAxis:function(n,t,i){var r,u,e,f;return f=this.getPseudoColumns(n,i),u=f.pseudoColumns,r=f.keys,e=d3.scale.ordinal().domain(r).rangeBands([0,r.length*t],0),function(n){var i;return u[n.id]==null?0:(i=u[n.id],e(i)-r.length*t/2)}},drawColumns:function(n,t,i,r,u,f,e){var h,o,s;return i=i.filter(function(n){return n.type==="column"}),s=this.getColumnAxis(i,r,u),i.forEach(function(n){return n.xOffset=s(n)+r*.5}),o=n.select(".content").selectAll(".columnGroup").data(i),h=o.enter().append("g").attr("class",function(n){return"columnGroup series_"+n.index}),o.attr("transform",function(n){return"translate("+s(n)+",0)"}),o.each(function(i){var o,h,s,c;if(h=u.series.map(function(n){return n.id}).indexOf(i.id),s=(c=u.series)!=null?c[h].visible:void 0,s===void 0||s===!0){o=d3.select(this).selectAll("rect").data(i.values);o.enter().append("rect").on({click:function(n,t){return e.click(n,t,i,n.raw)}}).on("mouseenter",function(n,t){return e.mouseenter(n,t,i,n.raw)}).on("mouseover",function(r,o){if(typeof f.onMouseOver=="function")f.onMouseOver(n,{series:i,x:t.xScale(r.x),y:t[r.axis+"Scale"](r.y0+r.y),datum:r},u.axes);return e.hover(r,o,i,r.raw),e.mouseover(r,o,i,r.raw)}).on("mouseout",function(t,r){if(typeof f.onMouseOut=="function")f.onMouseOut(n);return e.mouseout(t,r,i,t.raw)});return o.style({stroke:i.color,fill:i.color,"stroke-opacity":function(n){return n.y===0?"0":"1"},"stroke-width":"1px","fill-opacity":function(n){return n.y===0?0:.7}}).attr({width:r,x:function(n){return t.xScale(n.x)},height:function(n){return n.y===0?t[n.axis+"Scale"].range()[0]:Math.abs(t[n.axis+"Scale"](n.y0+n.y)-t[n.axis+"Scale"](n.y0))},y:function(n){return n.y===0?0:t[n.axis+"Scale"](Math.max(0,n.y0+n.y))}})}}),this},drawDots:function(n,t,i,r,u,f){var o,e;if(e=n.select(".content").selectAll(".dotGroup").data(i.filter(function(n){var t;return((t=n.type)==="line"||t==="area")&&n.drawDots})),o=e.enter().append("g").attr("class",function(n){return"dotGroup series_"+n.index}),e.attr("fill",function(n){return n.color}),e.each(function(n){var i=d3.select(this).selectAll(".dot").data(n.values);i.enter().append("circle").attr("class","dot").on({click:function(t,i){return f.click(t,i,n,t.raw)}}).on({mouseenter:function(t,i){return f.mouseenter(t,i,n,t.raw)}}).on({mouseover:function(t,i){return f.hover(t,i,n),f.mouseover(t,i,n,t.raw)}}).on({mouseout:function(t,i){return f.mouseout(t,i,n,t.raw)}});return i.attr({r:function(n){return n.dotSize},cx:function(n){return t.xScale(n.x)},cy:function(n){return t[n.axis+"Scale"](n.y+n.y0)}}).style({stroke:"white","stroke-width":"2px"})}),r.tooltip.mode!=="none")o.on("mouseover",function(t){var f,i;return i=d3.select(d3.event.target),f=i.datum(),i.attr("r",function(n){return n.dotSize+2}),typeof u.onMouseOver=="function"?u.onMouseOver(n,{series:t,x:i.attr("cx"),y:i.attr("cy"),datum:f},r.axes):void 0}).on("mouseout",function(){return d3.select(d3.event.target).attr("r",function(n){return n.dotSize}),typeof u.onMouseOut=="function"?u.onMouseOut(n):void 0});return this},getEventDispatcher:function(){var n;return n=["focus","hover","mouseenter","mouseover","mouseout","click","toggle"],d3.dispatch.apply(this,n)},resetZoom:function(n,t,i,r,u,f,e,o,s){return s.scale(1),s.translate([0,0]),this.getZoomHandler(n,t,i,r,u,f,e,o,!1)()},getZoomHandler:function(n,t,i,r,u,f,e,o,s){var h;return h=this,function(){var c;return c=!1,["x","y","y2"].forEach(function(t){var r;if(((r=f.axes[t])!=null?r.zoomable:void 0)!=null)return n.selectAll("."+t+".axis").call(i[""+t+"Axis"]),c=!0}),r.length&&(u=h.getBestColumnWidth(i,t,r,f),h.drawData(n,t,i,r,u,f,e,o)),s&&c?h.createZoomResetIcon(n,t,i,r,u,f,e,o,s):void 0}},setZoom:function(n,t,i,r,u,f,e,o){var s;if(s=this.getZoomListener(i,f),s){s.on("zoom",this.getZoomHandler(n,t,i,r,u,f,e,o,s));return n.call(s)}},getZoomListener:function(n,t){var i,r;return r=!1,i=d3.behavior.zoom(),["x","y","y2"].forEach(function(u){var f;if((f=t.axes[u])!=null?f.zoomable:void 0)return i[u](n[""+u+"Scale"]),r=!0}),r?i:!1},computeLegendLayout:function(n,t,i){var s,r,u,f,h,c,o,e,a,l;for(c=10,a=this,h=this.getLegendItemsWidths(n,"y"),f=[0],r=1;r<h.length;)f.push(h[r-1]+f[r-1]+c),r++;if(e=this.getLegendItemsWidths(n,"y2"),!(e.length>0))return[f];for(l=i.width-i.right-i.left,s=0,o=[],u=e.length-1;u>=0;)o.push(l-s-e[u]),s+=e[u]+c,u--;return o.reverse(),[f,o]},getLegendItemsWidths:function(n,t){var f,i,r,e,u;if(e=this,f=function(n){return e.getTextBBox(n).width},r=n.selectAll(".legendItem."+t),!(r.length>0))return[];for(u=[],i=0;i<r[0].length;)u.push(f(r[0][i])),i++;return u},drawLegend:function(n,t,i,r,u){var f,e,h,o,s;o=this;h=n.append("g").attr("class","legend");f=16;n.select("defs").append("svg:clipPath").attr("id","legend-clip").append("circle").attr("r",f/2);e=h.selectAll(".legendItem").data(t);e.enter().append("g").on("click",function(n,t){var i;return i=!(n.visible!==!1),u.toggle(n,t,i),typeof r.onSeriesVisibilityChange=="function"?r.onSeriesVisibilityChange({series:n,index:t,newVisibility:i}):void 0});return e.attr({"class":function(n,t){return"legendItem series_"+t+" "+n.axis},opacity:function(t,i){return t.visible===!1?(o.toggleSeries(n,i),"0.2"):"1"}}).each(function(n){var t,i;return t=d3.select(this),t.append("circle").attr({fill:n.color,stroke:n.color,"stroke-width":"2px",r:f/2}),t.append("path").attr({"clip-path":"url(#legend-clip)","fill-opacity":(i=n.type)==="area"||i==="column"?"1":"0",fill:"white",stroke:"white","stroke-width":"2px",d:o.getLegendItemPath(n,f,f)}),t.append("circle").attr({"fill-opacity":0,stroke:n.color,"stroke-width":"2px",r:f/2}),t.append("text").attr({"class":function(n,t){return"legendText series_"+t},"font-family":"Courier","font-size":10,transform:"translate(13, 4)","text-rendering":"geometric-precision"}).text(n.label||n.y)}),s=function(){var u,f,r;return r=o.computeLegendLayout(n,t,i),u=r[0],f=r[1],e.attr({transform:function(n){return n.axis==="y"?"translate("+u.shift()+","+(i.height-40)+")":"translate("+f.shift()+","+(i.height-40)+")"}})},s(),setTimeout(s,0),this},getLegendItemPath:function(n,t,i){var r,u;return n.type==="column"?(u="M"+-t/3+" "+-i/8+" l0 "+i+" ",u+="M0 "+-i/3+" l0 "+i+" ",u+("M"+t/3+" "+-i/10+" l0 "+i+" ")):(r="M-"+t/2+" 0"+i/3+" l"+t/3+" -"+i/3+" l"+t/3+" "+i/3+" l"+t/3+" -"+2*i/3,n.type==="area"&&r+" l0 "+i+" l-"+t+" 0z",r)},toggleSeries:function(n,t){var i;return i=!1,n.select(".content").selectAll(".series_"+t).style("display",function(){return d3.select(this).style("display")==="none"?(i=!0,"initial"):(i=!1,"none")}),i},drawLines:function(n,t,i,r,u){var e,o,s,f;if(e={y:this.createLeftLineDrawer(t,r.lineMode,r.tension),y2:this.createRightLineDrawer(t,r.lineMode,r.tension)},f=n.select(".content").selectAll(".lineGroup").data(i.filter(function(n){var t;return(t=n.type)==="line"||t==="area"})),s=f.enter().append("g").attr("class",function(n){return"lineGroup series_"+n.index}),f.style("stroke",function(n){return n.color}),f.each(function(n){var t;return t=d3.select(this).selectAll("path").data([n]),t.enter().append("path").attr("class","line"),t.attr("d",function(n){return e[n.axis](n.values)}).style({fill:"none","stroke-width":function(n){return n.thickness},"stroke-dasharray":function(n){if(n.lineMode==="dashed")return"10,3"}})}),r.tooltip.interpolate){o=function(i){var f,et,p,d,c,g,l,a,e,w,o,s,h,nt,b,v,tt,it,y,rt,ut,k,ft;nt=d3.select(d3.event.target);try{h=d3.mouse(this)}catch(ot){et=ot;h=[0,0]}for(b=nt.datum().values,p=k=0,ft=b.length;k<ft;p=++k)f=b[p],v=t.xScale(f.x),y=t.yScale(f.y),(typeof e=="undefined"||e===null||v<e)&&(e=v,w=f.x),(typeof c=="undefined"||c===null||v>c)&&(c=v,g=f.x),(typeof o=="undefined"||o===null||y<o)&&(o=y),(typeof l=="undefined"||l===null||y>l)&&(l=y),(typeof s=="undefined"||s===null||f.y<s)&&(s=f.y),(typeof a=="undefined"||a===null||f.y>a)&&(a=f.y);return tt=(h[0]-e)/(c-e),rt=(h[1]-o)/(l-o),it=Math.round(tt*(g-w)+w),ut=Math.round((1-rt)*(a-s)+s),d={x:it,y:ut},typeof u.onMouseOver=="function"?u.onMouseOver(n,{series:i,x:h[0],y:h[1],datum:d},r.axes):void 0};s.on("mousemove",o).on("mouseout",function(){if(typeof u.onMouseOut=="function")return u.onMouseOut(n)})}return this},createLeftLineDrawer:function(n,t,i){return d3.svg.line().x(function(t){return n.xScale(t.x)}).y(function(t){return n.yScale(t.y+t.y0)}).interpolate(t).tension(i)},createRightLineDrawer:function(n,t,i){return d3.svg.line().x(function(t){return n.xScale(t.x)}).y(function(t){return n.y2Scale(t.y+t.y0)}).interpolate(t).tension(i)},getPixelCssProp:function(t,i){var r;return r=n.getComputedStyle(t,null).getPropertyValue(i),+r.replace(/px$/,"")},getDefaultMargins:function(){return{top:20,right:50,bottom:60,left:50}},getDefaultThumbnailMargins:function(){return{top:1,right:1,bottom:2,left:0}},getElementDimensions:function(n,t,i){var f,u,e,r,o,s;return u={},r=n,s=this.getPixelCssProp(r,"padding-top"),f=this.getPixelCssProp(r,"padding-bottom"),e=this.getPixelCssProp(r,"padding-left"),o=this.getPixelCssProp(r,"padding-right"),u.width=+(t||r.offsetWidth||900)-e-o,u.height=+(i||r.offsetHeight||500)-s-f,u},getDimensions:function(n,t,i){var r;return r=this.getElementDimensions(t[0].parentElement,i.width,i.height),angular.extend(n.margin,r)},clean:function(n){return d3.select(n).on("keydown",null).on("keyup",null).select("svg").remove()},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t,i;return t=Math.random()*16|0,i=n==="x"?t:t&3|8,i.toString(16)})},bootstrap:function(n,t,i){var e,r,u,f;return d3.select(n).classed("chart",!0),f=i.width,r=i.height,u=d3.select(n).append("svg").attr({width:f,height:r}).append("g").attr("transform","translate("+i.left+","+i.top+")"),e=u.append("defs").attr("class","patterns"),e.append("clipPath").attr("class","content-clip").attr("id","content-clip-"+t).append("rect").attr({x:0,y:0,width:f-i.left-i.right,height:r-i.top-i.bottom}),u},createContent:function(n,t,i){var r;return r=n.append("g").attr("class","content"),i.hideOverflow?r.attr("clip-path","url(#content-clip-"+t+")"):void 0},createZoomResetIcon:function(n,t,i,r,u,f,e,o,s){var c,h,l,a,v,y,p;return y=this,a="M22.646,19.307c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127l3.535-3.537L22.646,19.307zM13.688,20.369c-3.582-0.008-6.478-2.904-6.484-6.484c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486C20.165,17.465,17.267,20.361,13.688,20.369zM8.854,11.884v4.001l9.665-0.001v-3.999L8.854,11.884z",h=n.select(".focus-container").selectAll(".icon.zoom-reset").data([1]),c=h.enter().append("g").attr("class","icon zoom-reset").on("click",function(){return y.resetZoom(n,t,i,r,u,f,e,o,s),d3.select(this).remove()}).on("mouseenter",function(){return d3.select(this).style("fill","steelblue")}).on("mouseout",function(){return d3.select(this).style("fill","black")}),c.append("path").attr("d",a),l=t.width-t.left-t.right-24,p=2,v=.7,h.style({fill:"black",stroke:"white","stroke-width":1.5}).attr({opacity:1,transform:"translate("+l+", "+p+") scale("+v+")"})},createFocus:function(n){return n.append("g").attr({"class":"focus-container"})},createGlass:function(n,t,i,r,u,f,e,o){var s,c,h;h=this;s=n.append("g").attr({"class":"glass-container",opacity:0});c=s.selectAll(".scrubberItem").data(u).enter().append("g").attr("class",function(n,t){return"scrubberItem series_"+t});c.each(function(n,t){var r,u,i;return i=d3.select(this),r=i.append("g").attr({"class":"rightTT"}),r.append("path").attr({"class":"scrubberPath series_"+t,y:"-7px",fill:n.color}),h.styleTooltip(r.append("text").style("text-anchor","start").attr({"class":function(n,t){return"scrubberText series_"+t},height:"14px",transform:"translate(7, 3)","text-rendering":"geometric-precision"})).text(n.label||n.y),u=i.append("g").attr({"class":"leftTT"}),u.append("path").attr({"class":"scrubberPath series_"+t,y:"-7px",fill:n.color}),h.styleTooltip(u.append("text").style("text-anchor","end").attr({"class":"scrubberText series_"+t,height:"14px",transform:"translate(-13, 3)","text-rendering":"geometric-precision"})).text(n.label||n.y),i.append("circle").attr({"class":"scrubberDot series_"+t,fill:"white",stroke:n.color,"stroke-width":"2px",r:4})});return s.append("rect").attr({"class":"glass",width:t.width-t.left-t.right,height:t.height-t.top-t.bottom}).style("fill","white").style("fill-opacity",1e-6).on("mouseover",function(){return i.onChartHover(n,d3.select(this),r,u,f,e,o)})},drawData:function(n,t,i,r,u,f,e,o){return this.drawArea(n,i,r,f,e).drawColumns(n,i,r,u,f,e,o).drawLines(n,i,r,f,e),f.drawDots?this.drawDots(n,i,r,f,e,o):void 0},getDataPerSeries:function(n,t){var f,u,i,r;return(i=t.series,f=t.axes,!(i&&i.length&&n&&n.length))?[]:(r=i.map(function(i,r){var u;return u={index:r,name:i.y,values:[],color:i.color,axis:i.axis||"y",xOffset:0,type:i.type,thickness:i.thickness,drawDots:i.drawDots!==!1},i.dotSize!=null&&(u.dotSize=i.dotSize),i.striped===!0&&(u.striped=!0),i.lineMode!=null&&(u.lineMode=i.lineMode),i.id&&(u.id=i.id),n.filter(function(n){return n[i.y]!=null}).forEach(function(n){var r;return r={x:n[t.axes.x.key],y:n[i.y],y0:0,axis:i.axis||"y",raw:n},i.dotSize!=null&&(r.dotSize=i.dotSize),u.values.push(r)}),u}),t.stacks==null||t.stacks.length===0)?r:(u=d3.layout.stack().values(function(n){return n.values}),t.stacks.forEach(function(n){var t;if((n.series.length>0))return t=r.filter(function(n,t){return i[t].visible===void 0||i[t].visible}).filter(function(t){var i;return t.id!=null&&(i=t.id,__indexOf.call(n.series,i)>=0)}),u(t)}),r)},estimateSideTooltipWidth:function(n,t){var r,i;return i=n.append("text"),i.text(""+t),this.styleTooltip(i),r=this.getTextBBox(i[0][0]),i.remove(),r},getTextBBox:function(n){var t;if(n!==null)try{return n.getBBox()}catch(i){return t=i,{height:0,width:0,y:0,x:0}}return{}},getWidestTickWidth:function(n,t){var r,i,u,f;return i=0,r=this.getTextBBox,u=n.select("."+t+".axis").selectAll(".tick"),(f=u[0])!=null&&f.forEach(function(n){return i=Math.max(i,r(n).width)}),i},getWidestOrdinate:function(n,t,i){var r;return r="",n.forEach(function(n){return t.forEach(function(t){var u,f;if(u=n[t.y],t.axis!=null&&((f=i.axes[t.axis])!=null?f.ticksFormatter:void 0)&&(u=i.axes[t.axis].ticksFormatter(u)),u!=null)return(""+u).length>(""+r).length?r=u:void 0})}),r},getDefaultOptions:function(){return{tooltip:{mode:"scrubber"},lineMode:"linear",tension:.7,margin:this.getDefaultMargins(),axes:{x:{type:"linear",key:"x"},y:{type:"linear"}},series:[],drawLegend:!0,drawDots:!0,stacks:[],columnsHGap:5,hideOverflow:!1}},sanitizeOptions:function(n,t){var i;return n==null&&(n={}),t==="thumbnail"&&(n.drawLegend=!1,n.drawDots=!1,n.tooltip={mode:"none",interpolate:!1}),n.series=this.sanitizeSeriesOptions(n.series),n.stacks=this.sanitizeSeriesStacks(n.stacks,n.series),n.axes=this.sanitizeAxes(n.axes,this.haveSecondYAxis(n.series)),n.tooltip=this.sanitizeTooltip(n.tooltip),n.margin=this.sanitizeMargins(n.margin),n.lineMode||(n.lineMode=this.getDefaultOptions().lineMode),n.tension=/^\d+(\.\d+)?$/.test(n.tension)?n.tension:this.getDefaultOptions().tension,n.drawLegend=n.drawLegend!==!1,n.drawDots=n.drawDots!==!1,angular.isNumber(n.columnsHGap)||(n.columnsHGap=5),n.hideOverflow=n.hideOverflow||!1,i=t==="thumbnail"?this.getDefaultThumbnailMargins():this.getDefaultMargins(),n.series=angular.extend(this.getDefaultOptions().series,n.series),n.axes=angular.extend(this.getDefaultOptions().axes,n.axes),n.tooltip=angular.extend(this.getDefaultOptions().tooltip,n.tooltip),n.margin=angular.extend(i,n.margin),n},sanitizeMargins:function(n){var r,i,t,u;r=["top","right","bottom","left"];i={};for(t in n)n.hasOwnProperty(t)&&(u=n[t],__indexOf.call(r,t)>=0&&(i[t]=parseFloat(u)));return i},sanitizeSeriesStacks:function(n,i){var r;return n==null?[]:(r={},i.forEach(function(n){return r[n.id]=n}),n.forEach(function(n){return n.series.forEach(function(i){var u;if(u=r[i],u!=null){if(u.axis!==n.axis)return t.warn("Series "+i+" is not on the same axis as its stack")}else if(!u)return t.warn("Unknown series found in stack : "+i)})}),n)},sanitizeTooltip:function(n){var t;if(!n)return{mode:"scrubber"};if((t=n.mode)!=="none"&&t!=="axes"&&t!=="scrubber"&&(n.mode="scrubber"),n.mode==="scrubber"?delete n.interpolate:n.interpolate=!!n.interpolate,n.mode==="scrubber"&&n.interpolate)throw new Error("Interpolation is not supported for scrubber tooltip mode.");return n},sanitizeSeriesOptions:function(n){var i,t;return n==null?[]:(i=d3.scale.category10(),t={},n.forEach(function(n){if(t[n.id]!=null)throw new Error("Twice the same ID ("+n.id+") ? Really ?");if(n.id!=null)return t[n.id]=n}),n.forEach(function(n,r){var u,e,f,o,s;if(n.axis=((e=n.axis)!=null?e.toLowerCase():void 0)!=="y2"?"y":"y2",n.color||(n.color=i(r)),n.type=(f=n.type)==="line"||f==="area"||f==="column"?n.type:"line",n.type==="column"?(delete n.thickness,delete n.lineMode,delete n.drawDots,delete n.dotSize):/^\d+px$/.test(n.thickness)||(n.thickness="1px"),((o=n.type)==="line"||o==="area")&&((s=n.lineMode)!=="dashed"&&delete n.lineMode,n.drawDots!==!1&&n.dotSize==null&&(n.dotSize=2)),n.id==null){for(u=0;t["series_"+u]!=null;)u++;n.id="series_"+u;t[n.id]=n}if(n.drawDots===!1)return delete n.dotSize}),n)},sanitizeAxes:function(n,t){var i;return n==null&&(n={}),n.x=this.sanitizeAxisOptions(n.x),(i=n.x).key||(i.key="x"),n.y=this.sanitizeAxisOptions(n.y),t&&(n.y2=this.sanitizeAxisOptions(n.y2)),n},sanitizeExtrema:function(n){var i,f,u,o,e,r;for(e=["min","max"],r=[],u=0,o=e.length;u<o;u++)i=e[u],f=n[i],f!=null?(n[i]=this.sanitizeExtremum(i,n),n[i]==null?r.push(t.warn("Invalid "+i+" value '"+f+"' (parsed as "+n[i]+"), ignoring it.")):r.push(void 0)):r.push(void 0);return r},sanitizeExtremum:function(n,t){var i;return i=this.sanitizeNumber,t.type==="date"&&(i=this.sanitizeDate),i(t[n])},sanitizeDate:function(n){if(n!=null)return!(n instanceof Date)||isNaN(n.valueOf())?void 0:n},sanitizeNumber:function(n){var t;if(n!=null)return(t=parseFloat(n),isNaN(t))?void 0:t},sanitizeAxisOptions:function(n){return n==null?{type:"linear"}:(n.type||(n.type="linear"),n.ticksRotate!=null&&(n.ticksRotate=this.sanitizeNumber(n.ticksRotate)),n.zoomable!=null&&(n.zoomable=n.zoomable||!1),n.innerTicks!=null&&(n.innerTicks=n.innerTicks||!1),n.labelFunction!=null&&(n.ticksFormatter=n.labelFunction),n.ticksFormat!=null&&(n.ticksFormatter=n.type==="date"?d3.time.format(n.ticksFormat):d3.format(n.ticksFormat),n.tooltipFormatter==null&&(n.tooltipFormatter=n.ticksFormatter)),n.tooltipFormat!=null&&(n.tooltipFormatter=n.type==="date"?d3.time.format(n.tooltipFormat):d3.format(n.tooltipFormat)),n.ticksInterval!=null&&(n.ticksInterval=this.sanitizeNumber(n.ticksInterval)),this.sanitizeExtrema(n),n)},createAxes:function(n,t,i){var a,r,s,u,o,h,f,e,c,l;return a=i.y2!=null,u=t.width,r=t.height,u=u-t.left-t.right,r=r-t.top-t.bottom,o=void 0,o=i.x.type==="date"?d3.time.scale().rangeRound([0,u]):d3.scale.linear().rangeRound([0,u]),h=this.createAxis(o,"x",i),f=void 0,f=i.y.type==="log"?d3.scale.log().clamp(!0).rangeRound([r,0]):d3.scale.linear().rangeRound([r,0]),f.clamp(!0),l=this.createAxis(f,"y",i),e=void 0,e=a&&i.y2.type==="log"?d3.scale.log().clamp(!0).rangeRound([r,0]):d3.scale.linear().rangeRound([r,0]),e.clamp(!0),c=this.createAxis(e,"y2",i),s=function(n){return n.style({font:"10px Courier","shape-rendering":"crispEdges"}),n.selectAll("path").style({fill:"none",stroke:"#000"})},{xScale:o,yScale:f,y2Scale:e,xAxis:h,yAxis:l,y2Axis:c,andAddThemIf:function(t){return!t.all||(!t.y||(n.append("g").attr("class","y grid"),n.append("g").attr("class","y axis").call(l).call(s)),a&&!!t.y2&&(n.append("g").attr("class","y2 grid").attr("transform","translate("+u+", 0)"),n.append("g").attr("class","y2 axis").attr("transform","translate("+u+", 0)").call(c).call(s)),!t.x||(n.append("g").attr("class","x grid").attr("transform","translate(0,"+r+")"),n.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(h).call(s))),{xScale:o,yScale:f,y2Scale:e,xAxis:h,yAxis:l,y2Axis:c}}}},createAxis:function(n,t,i){var u,r,f;return(f={x:"bottom",y:"left",y2:"right"},r=i[t],u=d3.svg.axis().scale(n).orient(f[t]).innerTickSize(4).tickFormat(r!=null?r.ticksFormatter:void 0),r==null)?u:(angular.isArray(r.ticks)?u.tickValues(r.ticks):angular.isNumber(r.ticks)?u.ticks(r.ticks):angular.isFunction(r.ticks)&&u.ticks(r.ticks,r.ticksInterval),u)},setDefaultStroke:function(n){return n.attr("stroke","#000").attr("stroke-width",1).style("shape-rendering","crispEdges")},setDefaultGrid:function(n){return n.attr("stroke","#eee").attr("stroke-width",1).style("shape-rendering","crispEdges")},setScalesDomain:function(n,t,i,r,u){var f,e,s,o,h,c,l,a,v;return this.setXScale(n.xScale,t,i,u.axes),f=r.selectAll(".x.axis").call(n.xAxis),u.axes.x.innerTicks!=null&&f.selectAll(".tick>line").call(this.setDefaultStroke),u.axes.x.grid!=null&&(s=u.margin.height-u.margin.top-u.margin.bottom,h=n.xAxis.tickSize(-s,0,0),e=r.selectAll(".x.grid").call(h),e.selectAll(".tick>line").call(this.setDefaultGrid)),u.axes.x.ticksRotate!=null&&f.selectAll(".tick>text").attr("dy",null).attr("transform","translate(0,5) rotate("+u.axes.x.ticksRotate+" 0,6)").style("text-anchor",u.axes.x.ticksRotate>=0?"start":"end"),i.filter(function(n){return n.axis==="y"&&n.visible!==!1}).length>0&&(a=this.getVerticalDomain(u,t,i,"y"),n.yScale.domain(a).nice(),f=r.selectAll(".y.axis").call(n.yAxis),u.axes.y.innerTicks!=null&&f.selectAll(".tick>line").call(this.setDefaultStroke),u.axes.y.ticksRotate!=null&&f.selectAll(".tick>text").attr("transform","rotate("+u.axes.y.ticksRotate+" -6,0)").style("text-anchor","end"),u.axes.y.grid!=null&&(o=u.margin.width-u.margin.left-u.margin.right,v=n.yAxis.tickSize(-o,0,0),e=r.selectAll(".y.grid").call(v),e.selectAll(".tick>line").call(this.setDefaultGrid))),i.filter(function(n){return n.axis==="y2"&&n.visible!==!1}).length>0&&(c=this.getVerticalDomain(u,t,i,"y2"),n.y2Scale.domain(c).nice(),f=r.selectAll(".y2.axis").call(n.y2Axis),u.axes.y2.innerTicks!=null&&f.selectAll(".tick>line").call(this.setDefaultStroke),u.axes.y2.ticksRotate!=null&&f.selectAll(".tick>text").attr("transform","rotate("+u.axes.y2.ticksRotate+" 6,0)").style("text-anchor","start"),u.axes.y2.grid!=null)?(o=u.margin.width-u.margin.left-u.margin.right,l=n.y2Axis.tickSize(-o,0,0),e=r.selectAll(".y2.grid").call(l),e.selectAll(".tick>line").call(this.setDefaultGrid)):void 0},getVerticalDomain:function(n,t,i,r){var f,e,u;return(u=n.axes[r])?u.ticks!=null&&angular.isArray(u.ticks)?[u.ticks[0],u.ticks[u.ticks.length-1]]:(e=i.filter(function(n){return n.axis===r&&n.visible!==!1}),f=this.yExtent(i.filter(function(n){return n.axis===r&&n.visible!==!1}),t,n.stacks.filter(function(n){return n.axis===r})),u.type==="log"&&(f[0]=f[0]===0?.001:f[0]),u.min!=null&&(f[0]=u.min),u.max!=null&&(f[1]=u.max),f):[]},yExtent:function(n,t,i){var f,u,r;return(r=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,f=[],i.forEach(function(t){return f.push(t.series.map(function(t){return n.filter(function(n){return n.id===t})[0]}))}),n.forEach(function(n){var t;return t=!1,i.forEach(function(i){var r;if(r=n.id,__indexOf.call(i.series,r)>=0)return t=!0}),t?void 0:f.push([n])}),f.forEach(function(n){return n=n.filter(Boolean),r=Math.min(r,d3.min(t,function(t){return n.reduce(function(n,i){return Math.min(n,t[i.y])},Number.POSITIVE_INFINITY)})),u=Math.max(u,d3.max(t,function(t){return n.reduce(function(n,i){return n+t[i.y]},0)}))}),r===u)?r>0?[0,r*2]:[r*2,0]:[r,u]},setXScale:function(n,t,i,r){var u,f;return u=this.xExtent(t,r.x.key,r.x.type),i.filter(function(n){return n.type==="column"}).length&&this.adjustXDomainForColumns(u,t,r.x.key),f=r.x,f.min!=null&&(u[0]=f.min),f.max!=null&&(u[1]=f.max),n.domain(u)},xExtent:function(n,t,i){var f,r,u,e;return(e=d3.extent(n,function(n){return n[t]}),r=e[0],u=e[1],r===u)?i==="date"?(f=864e5,[new Date(+r-f),new Date(+u+f)]):r>0?[0,r*2]:[r*2,0]:[r,u]},adjustXDomainForColumns:function(n,t,i){var r;return r=this.getAverageStep(t,i),angular.isDate(n[0])?(n[0]=new Date(+n[0]-r),n[1]=new Date(+n[1]+r)):(n[0]=n[0]-r,n[1]=n[1]+r)},getAverageStep:function(n,t){var i,r,u;if(!(n.length>1))return 0;for(u=0,r=n.length-1,i=0;i<r;)u+=n[i+1][t]-n[i][t],i++;return u/r},haveSecondYAxis:function(n){return!n.every(function(n){return n.axis!=="y2"})},showScrubber:function(n,t,i,r,u,f,e){var o=this;t.on("mousemove",function(){return n.selectAll(".glass-container").attr("opacity",1),o.updateScrubber(n,d3.mouse(this),i,r,u,f,e)});return t.on("mouseout",function(){t.on("mousemove",null);return n.selectAll(".glass-container").attr("opacity",0)})},getClosestPoint:function(n,t){var r,u,i,f;return(f=d3.bisector(function(n){return n.x}).left,i=f(n,t),i===0)?n[0]:i>n.length-1?n[n.length-1]:(r=n[i-1],u=n[i],t-r.x>u.x-t?u:r)},updateScrubber:function(n,t,i,r,u,f,e){var h,o,s,c,l,a;return l=t[0],a=t[1],h=function(n){return n.transition().duration(50)},s=this,o=[],r.forEach(function(t,r){var d,c,y,p,g,w,v,nt,b,e,tt,k,it;if(c=n.select(".scrubberItem.series_"+r),u.series[r].visible===!1){c.attr("opacity",0);return}return c.attr("opacity",1),tt=i.xScale.invert(l),it=i.yScale.invert(a),e=s.getClosestPoint(t.values,tt),f.focus(e,t.values.indexOf(e),[tt,it]),b=e.x+" : "+e.y,u.tooltip.formatter&&(b=u.tooltip.formatter(e.x,e.y,u.series[r],e.raw)),w=c.select(".rightTT"),g=w.select("text"),g.text(b),p=c.select(".leftTT"),y=p.select("text"),y.text(b),nt={right:s.getTextBBox(g[0][0]).width+5,left:s.getTextBBox(y[0][0]).width+5},v=t.axis==="y2"?"right":"left",k=i.xScale(e.x),v==="left"?k+s.getTextBBox(y[0][0]).x-10<0&&(v="right"):v==="right"&&k+nt.right>s.getTextBBox(n.select(".glass")[0][0]).width&&(v="left"),v==="left"?(h(w).attr("opacity",0),h(p).attr("opacity",1)):(h(w).attr("opacity",1),h(p).attr("opacity",0)),o[r]={index:r,x:k,y:i[e.axis+"Scale"](e.y+e.y0),side:v,sizes:nt},d=angular.isFunction(t.color)?t.color(e,t.values.indexOf(e)):t.color,c.selectAll("circle").attr("stroke",d),c.selectAll("path").attr("fill",d)}),o=this.preventOverlapping(o),c=Math.max(15,100/e),r.forEach(function(t,i){var e,r,l,f;if(u.series[i].visible!==!1)return r=o[i],e=n.select(".scrubberItem.series_"+i),l=e.select("."+r.side+"TT"),f=r.side==="left"?t.xOffset:-t.xOffset,l.select("text").attr("transform",function(){return r.side==="left"?"translate("+(-3-c-f)+", "+(r.labelOffset+3)+")":"translate("+(4+c+f)+", "+(r.labelOffset+3)+")"}),l.select("path").attr("d",s.getScrubberPath(r.sizes[r.side]+1,r.labelOffset,r.side,c+f)),h(e).attr({transform:"translate("+(o[i].x+t.xOffset)+", "+o[i].y+")"})})},getScrubberPath:function(n,t,i,r){var e,o,u,f;return e=18,o=r,n=n,u=i==="left"?1:-1,f=1,t!==0&&(f=Math.abs(t)/t),t||(t=0),["m0 0","l"+u+" 0","l0 "+(t+f),"l"+-u*(o+1)+" 0","l0 "+(-e/2-f),"l"+-u*n+" 0","l0 "+e,"l"+u*n+" 0","l0 "+(-e/2-f),"l"+u*(o-1)+" 0","l0 "+(-t+f),"l1 0","z"].join("")},preventOverlapping:function(n){var t,i,r,u;return r=18,t={},n.forEach(function(n){var i;return t[i=n.x]||(t[i]={left:[],right:[]}),t[n.x][n.side].push(n)}),i=function(n){var o,c,s,i,u,e,h,f,l;s=[];for(h in t)if(t.hasOwnProperty(h)&&(e=t[h],e[n].length!==0)){for(i={};e[n].length>0;){u=e[n].pop();o=!1;for(f in i)i.hasOwnProperty(f)&&(c=i[f],+f-r<=(l=u.y)&&l<=+f+r&&(c.push(u),o=!0));o||(i[u.y]=[u])}s.push(i)}return s},u=function(n){var f,i,t,o,r,u,e;r=20;for(f in n)if(n.hasOwnProperty(f)){u=n[f];for(e in u)if(u.hasOwnProperty(e)){if(t=u[e],i=t.length,i===1){t[0].labelOffset=0;continue}t=t.sort(function(n,t){return n.y-t.y});o=i%2==0?-(r/2)*(i/2):-(i-1)/2*r;t.forEach(function(n,t){return n.labelOffset=o+r*t})}}},u(i("left")),u(i("right")),n},getTooltipHandlers:function(n){return n.tooltip.mode==="scrubber"?{onChartHover:angular.bind(this,this.showScrubber)}:{onMouseOver:angular.bind(this,this.onMouseOver),onMouseOut:angular.bind(this,this.onMouseOut)}},styleTooltip:function(n){return n.attr({"font-family":"monospace","font-size":10,fill:"white","text-rendering":"geometric-precision"})},addTooltips:function(n,t,i){var u,r,c,f,e,o,s,h;return e=t.width,r=t.height,e=e-t.left-t.right,r=r-t.top-t.bottom,f=24,u=18,c=5,o=n.append("g").attr({id:"xTooltip","class":"xTooltip",opacity:0}),o.append("path").attr("transform","translate(0,"+(r+1)+")"),this.styleTooltip(o.append("text").style("text-anchor","middle").attr({width:f,height:u,transform:"translate(0,"+(r+19)+")"})),h=n.append("g").attr({id:"yTooltip","class":"yTooltip",opacity:0}),h.append("path"),this.styleTooltip(h.append("text").attr({width:u,height:f})),i.y2!=null?(s=n.append("g").attr({id:"y2Tooltip","class":"y2Tooltip",opacity:0,transform:"translate("+e+",0)"}),s.append("path"),this.styleTooltip(s.append("text").attr({width:u,height:f}))):void 0},onMouseOver:function(n,t,i){return this.updateXTooltip(n,t,i.x),t.series.axis==="y2"?this.updateY2Tooltip(n,t,i.y2):this.updateYTooltip(n,t,i.y)},onMouseOut:function(n){return this.hideTooltips(n)},updateXTooltip:function(n,t,i){var s,r,e,u,h,c,f,o;return c=t.x,r=t.datum,u=t.series,f=n.select("#xTooltip"),f.transition().attr({opacity:1,transform:"translate("+c+",0)"}),o=i.tooltipFormatter,h=o?o(r.x):r.x,e=f.select("text"),e.text(h),s=angular.isFunction(u.color)?u.color(r,u.values.indexOf(r)):u.color,f.select("path").style("fill",s).attr("d",this.getXTooltipPath(e[0][0]))},getXTooltipPath:function(n){var i,t,r;return r=Math.max(this.getTextBBox(n).width,15),i=18,t=5,"m-"+r/2+" "+t+" l0 "+i+" l"+r+" 0 l0 "+-i+"l"+(-r/2+t)+" 0 l"+-t+" -"+i/4+" l"+-t+" "+i/4+" l"+(-r/2+t)+" 0z"},updateYTooltip:function(n,t,i){var h,r,f,u,c,e,l,o,s;return l=t.y,r=t.datum,u=t.series,o=n.select("#yTooltip"),o.transition().attr({opacity:1,transform:"translate(0, "+l+")"}),s=i.tooltipFormatter,c=s?s(r.y):r.y,f=o.select("text"),f.text(c),e=this.getTextBBox(f[0][0]).width+5,f.attr({transform:"translate("+(-e-2)+",3)",width:e}),h=angular.isFunction(u.color)?u.color(r,u.values.indexOf(r)):u.color,o.select("path").style("fill",h).attr("d",this.getYTooltipPath(e))},updateY2Tooltip:function(n,t,i){var c,r,f,u,l,o,s,e,h;return s=t.y,r=t.datum,u=t.series,e=n.select("#y2Tooltip"),e.transition().attr("opacity",1),h=i.tooltipFormatter,l=h?h(r.y):r.y,f=e.select("text"),f.text(l),o=this.getTextBBox(f[0][0]).width+5,f.attr({transform:"translate(7, "+(parseFloat(s)+3)+")",w:o}),c=angular.isFunction(u.color)?u.color(r,u.values.indexOf(r)):u.color,e.select("path").style("fill",c).attr({d:this.getY2TooltipPath(o),transform:"translate(0, "+s+")"})},getYTooltipPath:function(n){var i,t;return i=18,t=5,"m0 0l"+-t+" "+-t+" l0 "+(-i/2+t)+" l"+-n+" 0 l0 "+i+" l"+n+" 0 l0 "+(-i/2+t)+"l"+-t+" "+t+"z"},getY2TooltipPath:function(n){var i,t;return i=18,t=5,"m0 0l"+t+" "+t+" l0 "+(i/2-t)+" l"+n+" 0 l0 "+-i+" l"+-n+" 0 l0 "+(i/2-t)+" l"+-t+" "+t+"z"},hideTooltips:function(n){return n.select("#xTooltip").transition().attr("opacity",0),n.select("#yTooltip").transition().attr("opacity",0),n.select("#y2Tooltip").transition().attr("opacity",0)}}}]);
//# sourceMappingURL=line-chart.min.js.map
